---
title: "W10: Obiegi Parowe (Siłownie)"
subtitle: "Obieg Rankine'a i Układy Parowo-Gazowe"
author: "<span style='font-size: 1.5em;'>**dr hab. inż. prof. UPP Marek Urbaniak**</span>"
institute: |
  Wydział Inżynierii Środowiska i Inżynierii Mechanicznej<br><br>
  <div style="display: flex; justify-content: left; align-items: center; gap: 40px;">
    <img src="https://www.up.poznan.pl/sites/default/files/2024-10/logo_zielone_polskie_uklad_poziomy.png" style="height: 200px;">
    <img src="https://wisim.up.poznan.pl/sites/default/files/2023-02-13%2011%3A41/logo_wisim06.jpg" style="height: 200px;">
    <img src="img/KBiG.jpg" style="height: 200px;">
  </div>
lang: pl
format:
  revealjs:
    theme: ["theme/q-theme.scss"]
    include-in-header:
      text: |
        <style>
        body { background-color: #1a1a1a; }
        .reveal .slide-background-content {
            background-image: url("img/background_blue.png") !important;
            background-size: contain !important; 
            background-repeat: no-repeat !important;
            background-position: center center !important;
            opacity: 0.2 !important;
        }
        .reveal .backgrounds .slide-background:nth-child(1) .slide-background-content {
            background-image: none !important;
            background-color: white !important;
            opacity: 1 !important;
            filter: grayscale(30%); 
        }
        @keyframes pulse-opacity {
            0% { opacity: 1; }
            50% { opacity: 0.5; } /* Przygaśnięcie do 50% */
            100% { opacity: 1; }
        }

        /* Klasa, którą przypiszemy do ramki */
        .pulsing-warning {
          animation: pulse-opacity 4s infinite ease-in-out;
        }
        </style>
    slide-number: c/t
    show-slide-number: all
    transition: slide
    chalkboard: true
    footer: "Termodynamika Techniczna (W10)"
    width: 1600
    height: 900
    margin: 0.2
    revealjs-plugins:
      - appearance
      - pointer
    pointer:
      color: "#e60000"
      pointerSize: 20
editor: source
---

## Agenda Wykładu {data-menu-title="Agenda"}

1.  **Fundament Energetyki** (Dlaczego para?)
2.  **Obieg Clausiusa-Rankine'a** (Schemat i T-s)
3.  **Suchość Pary** i erozja łopatek.
4.  **Przegrzew Wtórny** (Reheat)
5.  **Regeneracja Podgrzewaczowa** (Regeneration)
6.  **Układy Gazowo-Parowe** (IGCC/CCGT)

---

## 1. Dlaczego Para Wodna?

::: {.callout-note appearance="simple"}
Siłownie parowe produkują >70% elektryczności na świecie (węgiel, atom, biomasa).
Woda jest tania, nietoksyczna i ma **ogromne ciepło parowania**.
:::

### Komponenty Siłowni:


::: {.incremental}
1.  **Pompa wodna:** Spręża ciecz (mała praca, bo ciecz nieściśliwa).
2.  **Kocioł (Generator Pary):** Dostarcza ciepło, zamienia wodę w parę.
3.  **Turbina:** Para rozpręża się, napędzając generator.
4.  **Skraplacz:** Para skrapla się do wody (oddając ciepło do rzeki/chłodni).
:::

---

## Obieg Carnota dla Pary Wodnej

> Obieg Carnota jest teoretycznym maksimum sprawności, ale w praktyce jest niemożliwy do zrealizowania dla pary wodnej.

W teorii, aby osiągnąć maksymalną sprawność, para musiałaby być skraplana do cieczy nasyconej, **a następnie sprężana do ciśnienia kotła**, co jest niemożliwe do zrealizowania w praktyce.

![](img/Carnot_pw.png)

::: {style="font-size: 0.6em; color: gray;"}
Źródło: "Termodynamika Techniczna" Wiśniewski (2017)
:::

---

## 2. Obieg Clausiusa-Rankine'a (C-R)

::: {.callout-note appearance="simple"}
Jest to obieg porównawczy dla elektrowni parowych i jądrowych. W przeciwieństwie do Otto/Diesla, zachodzi tu **zmiana fazy** czynnika.
:::

::: {.callout-important appearance="simple"}
Jest to realizacja obiegu Carnota dla pary, ale z modyfikacjami.
:::

::: {.fragment style="border: 2px solid #e60000; padding: 20px; border-radius: 10px; background-color: #fff0f0;"}
Wykres h-s (Molliera) jest kluczowy do analizy tego obiegu, ponieważ praca techniczna i ciepło są odcinkami entalpii ($\Delta h$).

::: incremental
*   **Praca turbiny:** $l_t = h_3 - h_4$ (spadek entalpii w pionie dla idealnej turbiny).
*   **Ciepło doprowadzone:** $q_{in} = h_3 - h_2$ (różnica entalpii pary wylotowej i wody zasilającej).

:::
:::

::: {.fragment .callout-note appearance="simple" style="font-size: 1.1em; color: navy;"}
Praca pompy jest zwykle pomijalnie mała.
:::

---

## Wykres T-s dla C-R

:::: {.columns}

::: {.column width="60%"}

```{r}
#| label: rankine-ts
#| echo: false
#| fig-width: 10
#| fig-height: 6
#| warning: false
#| message: false

library(ggplot2)

# --- 1. DOME CONSTRUCTION (Krzywa nasycenia) ---
# Uproszczona parametryzacja dzwonu nasycenia dla wody
s_crit <- 4.43 # Entropia krytyczna (przybliżona)
T_crit <- 647 # Temperatura krytyczna [K]

# Lewa gałąź (Ciecz)
s_liq <- seq(0, s_crit, length.out = 100)
# Funkcja przybliżająca: T = T_crit - a*(s_crit - s)^2
T_liq <- T_crit - 25 * (s_crit - s_liq)^2.5
# Korekta dla niskich entropii (żeby nie spadało za nisko)
T_liq <- pmax(T_liq, 273)

# Prawa gałąź (Para)
s_vap <- seq(s_crit, 9, length.out = 100)
# Funkcja przybliżająca prawą stronę
T_vap <- T_crit - 10 * (s_vap - s_crit)^2.5
T_vap <- pmax(T_vap, 273)

dome <- data.frame(
    s = c(s_liq, s_vap),
    T = c(T_liq, T_vap),
    type = c(rep("liq", 100), rep("vap", 100))
)
# Filtrowanie zerowych temperatur (błędy aproksymacji)
dome <- dome[dome$T > 270, ]


# --- 2. CYCLE POINTS (Obieg C-R) ---
# Założenia:
p_cond <- 0.1 # bar (T_sat ~ 320 K)
p_boiler <- 100 # bar (T_sat ~ 584 K)

# Punkt 1: Wlot do pompy (Ciecz nasycona pod ciśnieniem skraplacza)
# Znajdujemy s na lewej gałęzi dla T=320
T1 <- 320
s1 <- approx(dome$T[dome$type == "liq"], dome$s[dome$type == "liq"], xout = T1)$y
# Punkt 2: Wylot z pompy (Sprężanie izentropowe) -> s2 = s1
s2 <- s1
# T2 nieco wyższa (zaniedbywalnie mało dla wody, ale na wykresie pokażemy przesadzone)
T2 <- T1 + 50

# Punkt 2': Ciecz nasycona pod ciśnieniem kotła (Początek wrzenia)
T_sat_boiler <- 584 # K (ok. 311 C dla 100 bar)
s2_prim <- approx(dome$T[dome$type == "liq"], dome$s[dome$type == "liq"], xout = T_sat_boiler)$y

# Punkt 3'': Para nasycona sucha (Koniec wrzenia)
s3_dub_prim <- approx(dome$T[dome$type == "vap"], dome$s[dome$type == "vap"], xout = T_sat_boiler)$y

# Punkt 3: Przegrzewacz (Wylot z kotła)
T3 <- 823 # K (550 C)
# Izoabara w przegrzewaczu: przybliżenie s3
# cp * ln(T3/T_sat) = s3 - s3''
# s3 = s3'' + cp_vapor * ln(T3/T_sat)
s3 <- s3_dub_prim + 2.1 * log(T3 / T_sat_boiler)

# Punkt 4: Wylot z turbiny (Ekspansja izentropowa) -> s4 = s3 (Idealna)
# Jeśli s4 < s_vap(T1), to mamy parę mokrą
s4 <- s3
T4 <- T1 # Skraplacz jest izobarą i izotermą (w obszarze pary mokrej)

# --- 3. PROCESY (GENEROWANIE LINII) ---

# 1-2: Pompa (Pionowo)
df_12 <- data.frame(s = c(s1, s2), T = c(T1, T2))

# 2-2': Podgrzewanie wody (Wzdłuż krzywej nasycenia, ale nieco w lewo - izobara cieczy)
# Dla uproszczenia rysujemy prostą, bo lewa gałąź jest stroma
df_22p <- data.frame(s = c(s2, s2_prim), T = c(T2, T_sat_boiler))

# 2'-3'': Wrzenie (Poziomo)
df_2p3dp <- data.frame(s = c(s2_prim, s3_dub_prim), T = c(T_sat_boiler, T_sat_boiler))

# 3''-3: Przegrzew (Krzywa logarytmiczna w górę)
temps_sup <- seq(T_sat_boiler, T3, length.out = 20)
s_sup <- s3_dub_prim + 2.1 * log(temps_sup / T_sat_boiler)
df_3dp3 <- data.frame(s = s_sup, T = temps_sup)

# 3-4: Turbina (Pionowo w dół)
df_34 <- data.frame(s = c(s3, s4), T = c(T3, T4))

# 4-1: Skraplacz (Poziomo w lewo)
df_41 <- data.frame(s = c(s4, s1), T = c(T4, T1))

# --- 4. WYKRES ---
ggplot() +
    # Krzywa nasycenia (Dzwon)
    geom_line(data = dome, aes(x = s, y = T), color = "gray50", size = 1, linetype = "solid") +
    annotate("text", x = s_crit, y = T_crit + 20, label = "Punkt Krytyczny", size = 7, fontface = "italic") +

    # Linie Obiegu
    geom_path(data = df_12, aes(x = s, y = T), color = "blue", size = 1.5) + # Pompa
    geom_path(data = df_22p, aes(x = s, y = T), color = "red", size = 1.5) + # Podgrzewanie
    geom_path(data = df_2p3dp, aes(x = s, y = T), color = "red", size = 1.5) + # Wrzenie
    geom_path(data = df_3dp3, aes(x = s, y = T), color = "red", size = 1.5) + # Przegrzew
    geom_path(data = df_34, aes(x = s, y = T), color = "orange", size = 1.5, arrow = arrow(length = unit(0.3, "cm"), ends = "last")) + # Turbina
    geom_path(data = df_41, aes(x = s, y = T), color = "cyan3", size = 1.5, arrow = arrow(length = unit(0.3, "cm"), ends = "last")) + # Skraplacz

    # Punkty węzłowe
    annotate("point",
        x = c(s1, s2, s2_prim, s3_dub_prim, s3, s4),
        y = c(T1, T2, T_sat_boiler, T_sat_boiler, T3, T4), size = 3
    ) +

    # Opisy punktów
    annotate("text", x = s1 - 0.2, y = T1, label = "1", size = 5, fontface = "bold") +
    annotate("text", x = s2 - 0.2, y = T2 + 15, label = "2", size = 5, fontface = "bold") +
    annotate("text", x = s3, y = T3 + 20, label = "3", size = 5, fontface = "bold") +
    annotate("text", x = s4 + 0.2, y = T4, label = "4", size = 5, fontface = "bold") +

    # Opisy Procesów
    annotate("text", x = (s2 + s3) / 2, y = T3 + 50, label = "Kocioł (q['in'])", color = "red", size = 7, fontface = "bold", parse = TRUE) +
    annotate("text", x = s3 + 0.5, y = (T3 + T4) / 2, label = "Turbina", color = "orange", size = 7, fontface = "bold", angle = -90) +
    annotate("text", x = (s1 + s4) / 2, y = T1 - 30, label = "Skraplacz (q['out'])", color = "cyan3", size = 7, fontface = "bold", parse = TRUE) +
    theme_bw() +
    labs(
        title = "Rzeczywisty Obieg Rankine'a (T-s)",
        subtitle = "Z uwzględnieniem podgrzewania, wrzenia i przegrzewania",
        x = "Entropia właściwa s [kJ/(kg·K)]",
        y = "Temperatura T [K]"
    ) +
    theme(
        plot.title = element_text(size = 18, face = "bold"),
        axis.title = element_text(size = 20), axis.text = element_text(size = 14)
    )
```

::: {.fragment .callout-warning .pulsing-warning title="Uwaga"}
Odcinek **1-2** został sztucznie powiększony, dla lepszego poglądu<br>W rzeczywistości woda jest w zasadzie nieściśliwa.
:::
:::

::: {.column width="40%"}
::: {.incremental}
1.  **1-2:** Sprężanie izentropowe wody w pompie.
2.  **2-3:** Izobaryczne podgrzewanie i wrzenie w kotle.
3.  **3-4:** Rozprężanie izentropowe pary w turbinie.
4.  **4-1:** Izobaryczne (i izotermiczne) skraplanie.
:::

::: fragment
**Sprawność:**
$$ \eta_{C-R} = \frac{l_{turbiny} - l_{pompy}}{q_{dostarczone}} \approx \frac{h_3 - h_4}{h_3 - h_2} $$

:::
:::
::::

---

## Wykres h-s (Molliera) dla C-R

:::: {.columns}

::: {.column width="60%"}

```{r}
#| label: rankine-hs
#| echo: false
#| fig-width: 10
#| fig-height: 6
#| warning: false
#| message: false

library(ggplot2)

# --- 1. DOME (REALISTIC) ---
s_liq_real <- c(0.0, 1.3, 2.3, 3.25, 4.43)
h_liq_real <- c(0, 419, 852, 1344, 2100)
spline_liq <- spline(s_liq_real, h_liq_real, n = 100)

s_vap_real <- c(4.43, 5.7, 6.4, 7.35, 9.15)
h_vap_real <- c(2100, 2749, 2793, 2676, 2500)
spline_vap <- spline(s_vap_real, h_vap_real, n = 100)

dome_liq_df <- data.frame(s = spline_liq$x, h = spline_liq$y)
dome_vap_df <- data.frame(s = spline_vap$x, h = spline_vap$y)

# --- 2. POINTS & PROCESSES (VISUAL TWEAKS) ---

# P1 (Condenser out): s=0.65, h=192
p1 <- data.frame(s = 0.65, h = 192)

# P2 (Pump out): REALITY: dh ~ 10. VISUAL: dh ~ 150 to make it visible
# Vertical compression
p2 <- data.frame(s = 0.65, h = 350)

# P2' (Boiler bubbles): On Liquid Line.
# Visual shift: 100 bar is slightly left/up of sat line, but ends at sat line.
# Let's say it hits saturation at T_sat ~ 311C (s ~ 3.36, h ~ 1407)
p2p <- data.frame(s = 3.36, h = 1407)

# P3'' (Boiler dry steam): On Vapor Line. T_sat ~ 311C (s ~ 5.61, h ~ 2725)
p3pp <- data.frame(s = 5.61, h = 2725)

# P3 (Superheated): s=6.75, h=3500
p3 <- data.frame(s = 6.75, h = 3500)

# P4 (Turbine Out): s=6.75, h=2130 (approx)
p4 <- data.frame(s = 6.75, h = 2130)

# --- 3. CURVED PROCESS LINES ---

# 1-2 (Pump): Straight Vertical
df_12 <- rbind(p1, p2)

# 2-2' (Water Heating): Isobar moves parallel-ish to liquid line
# Generate slight curve connecting P2 to P2'
# Simple interpolation
s_heat <- seq(p2$s, p2p$s, length.out = 20)
# Linear h might look too straight. Let's curve it slightly up (concave up like liquid line)
# Using a power function relative to liquid line?
# Simple approach: Linear interp + slight offset or just straight is fine for liquid.
# Liquid isobar IS very close to straight on h-s visually.
df_22p <- data.frame(s = s_heat, h = seq(p2$h, p2p$h, length.out = 20))

# 2'-3'' (Evaporation): Straight Line (T=const -> Slope=const)
df_2p3pp <- rbind(p2p, p3pp)

# 3''-3 (Superheat): CURVED UP
# Isobar slope T increases. So it's convex.
# Fit a quadratic or spline between 3'' and 3
s_sup <- seq(p3pp$s, p3$s, length.out = 30)
# h(s) approx quadratic
# We know slope at 3'' is T_sat (~584 K). Slope at 3 is T_sup (~823 K).
# Let's just do a spline that looks nice visually (bending up)
# Add a control point in middle
mid_s <- (p3pp$s + p3$s) / 2
mid_h <- (p3pp$h + p3$h) / 2 - 100 # LOWER the mid point to make it "sag" up? No, convex means bending UP (slope increases).
# Wait, h-s slope is positive. Increasing slope means it gets STEEPER.
# So it should look like a "bowl" opening up (u-shape left side).
# h roughly grows with T.
# Let's use simple x^2 curve.
# h = a*s^2 + b*s + c
fit <- lm(h ~ poly(s, 2), data = rbind(p3pp, p3, data.frame(s = mid_s, h = mid_h + 150))) # Push mid point down to make it start flat and go steep?
# Actually, slope at 3'' (584K) is smaller than at 3 (823K). So it gets steeper.
# The curve should be concave UP (`U` shape).
# So mid point should initially be LOWER than the straight line? No.
# If I draw a line from A to B. If curve is U-shaped, the curve is BELOW the line.
# Yes. So intermediate h should be < linear interp.
h_linear <- approx(c(p3pp$s, p3$s), c(p3pp$h, p3$h), xout = s_sup)$y
h_sup <- h_linear - 50 * sin(pi * seq(0, 1, length.out = 30)) # Sag below the line
df_3pp3 <- data.frame(s = s_sup, h = h_sup)

# 3-4 (Turbine): Straight Vertical
df_34 <- rbind(p3, p4)

# 4-1 (Condenser): Straight Line (T=const=low)
# Note: P4 is at s=6.75, h=2130. P1 is at s=0.65, h=192.
# Slope = (2130-192)/(6.75-0.65) = 1938/6.1 = 317 K (44 C). matches T_cond perfectly.
df_41 <- rbind(p4, p1)

ggplot() +
    # Dome
    geom_line(data = dome_liq_df, aes(x = s, y = h), color = "gray50", size = 1) +
    geom_line(data = dome_vap_df, aes(x = s, y = h), color = "gray50", size = 1) +
    annotate("text", x = 8.0, y = 2750, label = "x=1", size = 5, fontface = "italic", color = "gray50") +
    annotate("text", x = 4.43, y = 1900, label = "P.Krytyczny", size = 4, fontface = "italic", color = "gray50") + # Adjusted label pos

    # 1-2 Pump
    geom_path(data = df_12, aes(x = s, y = h), color = "blue", size = 2, arrow = arrow(length = unit(0.3, "cm"), ends = "last")) +

    # 2-3 Boiler (Heating + Evap + Superheat)
    geom_path(data = df_22p, aes(x = s, y = h), color = "red", size = 1.5) +
    geom_path(data = df_2p3pp, aes(x = s, y = h), color = "red", size = 1.5) +
    geom_path(data = df_3pp3, aes(x = s, y = h), color = "red", size = 1.5, arrow = arrow(length = unit(0.3, "cm"), ends = "last")) +

    # 3-4 Turbine
    geom_path(data = df_34, aes(x = s, y = h), color = "orange", size = 2, arrow = arrow(length = unit(0.5, "cm"), ends = "last")) +

    # 4-1 Condenser
    geom_path(data = df_41, aes(x = s, y = h), color = "cyan3", size = 1.5) + # Arrow at end usually overlaps with 1

    # Points
    annotate("point",
        x = c(p1$s, p2$s, p3$s, p4$s),
        y = c(p1$h, p2$h, p3$h, p4$h), size = 4
    ) +

    # Labels
    annotate("text", x = p1$s - 0.2, y = p1$h, label = "1", size = 6, fontface = "bold") +
    annotate("text", x = p2$s - 0.2, y = p2$h, label = "2", size = 6, fontface = "bold") +
    annotate("text", x = p3$s, y = p3$h + 150, label = "3", size = 6, fontface = "bold") +
    annotate("text", x = p4$s, y = p4$h - 150, label = "4", size = 6, fontface = "bold") +

    # process labels
    annotate("text", x = (p2$s + p3pp$s) / 2, y = (p2$h + p3pp$h) / 2 + 200, label = "'q'['in']~'(Izobara)'", color = "red", angle = 25, parse = TRUE) +
    annotate("text", x = (p4$s + p1$s) / 2, y = (p4$h + p1$h) / 2 - 100, label = "'q'['out']~'(Izobara)'", color = "cyan3", angle = 15, parse = TRUE) +
    labs(
        title = "Obieg Rankine'a: Wykres h-s (Molliera)",
        # subtitle="Wyraźnie widoczna praca pompy (przeskalowana) i krzywizny izobar",
        x = "Entropia s [kJ/(kg·K)]", y = "Entalpia h [kJ/kg]"
    ) +
    theme_bw() +
    theme(
        plot.title = element_text(size = 18, face = "bold"),
        axis.title = element_text(size = 14)
    )
```

::: {.fragment .callout-warning .pulsing-warning title="Uwaga"}
Odcinek **1-2** został sztucznie powiększony, dla lepszego poglądu<br>W rzeczywistości woda jest w zasadzie nieściśliwa.
:::
:::

::: {.column width="40%"}

### Zalety wykresu h-s{.fragment}

::: {.incremental}
1.  **Entalpia na osi Y:**
    Wszystkie wielkości energetyczne (Praca, Ciepło) są pionowymi odcinkami. Nie trzeba liczyć pól powierzchni (jak w T-s).

2.  **Turbina to pionowa linia:**
    Dla idealnej turbiny ($s=const$), proces jest pionową kreską w dół.
    
3.  **Łatwy odczyt spadku entalpii:**
    $$ l_t = h_3 - h_4 $$
    To jest kluczowa wielkość dla projektanta turbiny.

:::
:::
::::

---

## Rzeczywisty obieg Rankine'a

![](img/rankine_rzeczywisty.png)

::: {style="font-size: 0.6em; color: gray;"}
Źródło: "Termodynamika Techniczna" Wiśniewski (2017)
:::

---

## Sprawność Izentropowa Turbiny ($\eta_{is}$)

Rzeczywista turbina nie jest idealna — występują tarcie, straty cieplne i turbulencje. Definiujemy sprawność izentropową jako stosunek pracy rzeczywistej do idealnej:

$$ \eta_{is} = \frac{h_1 - h_{2r}}{h_1 - h_{2s}} $$

::: {.columns}
::: {.column width="50%"}
::: {.fragment .callout-note}
*   $h_{2s}$ — entalpia na wylocie w procesie idealnym (izentropowym, $s=const$)
*   $h_{2r}$ — entalpia na wylocie w procesie rzeczywistym
*   Typowe wartości: $\eta_{is} = 0.75 - 0.90$
:::
:::
::: {.column width="50%"}
::: {.fragment .callout-tip}
**Rzeczywista entalpia wylotowa:**
$$ h_{2r} = h_1 - \eta_{is} \cdot (h_1 - h_{2s}) $$

Na wykresie h-s linia rozprężania **odchyla się w prawo** (wzrost entropii), ponieważ proces jest nieodwracalny.
:::
:::
:::

---

## 3. Problem Wilgotności (Erozja)

::: {.callout-caution title="Ograniczenia"}
Zauważ, że punkt 4 (wylot z turbiny) leży "pod kopułą".
Oznacza to, że jest to **para mokra** (mieszanina pary i kropelek wody).
:::

::: fragment
*   Jeśli $x < 0.85-0.90$ (więcej niż 10-15% wody):
    *   Kropelki wody uderzają w łopatki wirnika z prędkością kilkuset m/s.
    *   Powoduje to **erozję** (wżery) i zniszczenie turbiny.
    
:::
::: {.fragment .callout-tip title="**Rozwiązanie:**"}
Musimy przesunąć punkt 4 w prawo. Jak?
:::

::: {.incremental}
1.  Zwiększyć temperaturę przegrzania $T_3$ (Limity materiałowe stali).
2.  Zastosować **Przegrzew Wtórny**.
:::

---

## 4. Przegrzew Wtórny (Reheat)


::: {.callout-tip title="Proces:"}
1.  Para rozpręża się w turbinie Wysokoprężnej (HP) tylko częściowo (nie wchodzi głęboko pod kopułę).
2.  Wracamy z parą do kotła i podgrzewamy ją ponownie do $T_{max}$.
3.  Para wraca do turbiny Niskoprężnej (LP) i rozpręża się do ciśnienia skraplacza.
:::

::: {.fragment .callout-tip title="**Zalety:**"}
*   Punkt końcowy przesuwa się w prawo (para suchsza).
*   Zwiększa się średnia temperatura dostarczania ciepła ($\eta \uparrow$).
*   Większa praca z 1 kg pary (dwa etapy ekspansji).

:::

---

## Wykres h-s: Przegrzew Wtórny

:::: {.columns}

::: {.column width="60%"}

```{r}
#| label: reheat-hs
#| echo: false
#| fig-width: 10
#| fig-height: 6
#| warning: false
#| message: false

library(ggplot2)

# --- 1. DOME (SAME AS BEFORE) ---
s_liq_real <- c(0.0, 1.3, 2.3, 3.25, 4.43)
h_liq_real <- c(0, 419, 852, 1344, 2100)
spline_liq <- spline(s_liq_real, h_liq_real, n = 100)

s_vap_real <- c(4.43, 5.7, 6.4, 7.35, 9.15)
h_vap_real <- c(2100, 2749, 2793, 2676, 2500)
spline_vap <- spline(s_vap_real, h_vap_real, n = 100)

dome_liq_df <- data.frame(s = spline_liq$x, h = spline_liq$y)
dome_vap_df <- data.frame(s = spline_vap$x, h = spline_vap$y)

# --- 2. REHEAT POINTS ---

# P3 (HP Inlet): 100 bar, 550C -> s=6.75, h=3500
p3 <- data.frame(s = 6.75, h = 3500)

# P3a (HP Outlet): 20 bar. Isentropic s=6.75.
# At 20 bar, s_sat_vap ~ 6.34, so it is still superheated or close.
# Let's say h ~ 2900 (just approximate for visual)
p3a <- data.frame(s = 6.75, h = 2900)

# P3b (LP Inlet / Reheat): 20 bar, reheated to 550C.
# Pressure is lower than P3, so entropy is higher for same T.
# s ~ 7.7, h ~ 3600 (approx)
p3b <- data.frame(s = 7.7, h = 3600)

# P4 (LP Outlet): 0.1 bar. Isentropic from P3b. s=7.7.
# s_liq=0.65, s_vap=8.15. x = (7.7-0.65)/7.5 = 0.94 (Very dry!)
# h = 192 + 0.94*2392 ~ 2440
p4 <- data.frame(s = 7.7, h = 2440)

# P4_old (No Reheat): Continued expansion from 3.
# s=6.75. We calculated h=2130 (x=0.81).
p4_old <- data.frame(s = 6.75, h = 2130)


# --- 3. PROCESS LINES ---
df_3_3a <- rbind(p3, p3a) # HP Turbine
df_3a_3b <- rbind(p3a, p3b) # Reheat (Isobar 20 bar) - simplified as straight/curved
# Reheat isobar starts superheated or dry, goes to more superheated. Curve convex up.
s_rh <- seq(p3a$s, p3b$s, length.out = 20)
h_rh_lin <- approx(c(p3a$s, p3b$s), c(p3a$h, p3b$h), xout = s_rh)$y
h_rh <- h_rh_lin - 30 * sin(pi * seq(0, 1, length.out = 20)) # Convex curve
df_3a_3b <- data.frame(s = s_rh, h = h_rh)

df_3b_4 <- rbind(p3b, p4) # LP Turbine

# Comparison line (No Reheat)
df_no_rh <- rbind(p3a, p4_old)

ggplot() +
    # Dome
    geom_line(data = dome_liq_df, aes(x = s, y = h), color = "gray50", size = 1) +
    geom_line(data = dome_vap_df, aes(x = s, y = h), color = "gray50", size = 1) +
    annotate("text", x = 8.0, y = 2750, label = "x=1", size = 5, fontface = "italic", color = "gray50") +
    annotate("text", x = 4.43, y = 1900, label = "P.Krytyczny", size = 4, fontface = "italic", color = "gray50") +

    # HP Turbine
    geom_path(data = df_3_3a, aes(x = s, y = h), color = "orange", size = 2, arrow = arrow(length = unit(0.4, "cm"), ends = "last")) +

    # Reheat
    geom_path(data = df_3a_3b, aes(x = s, y = h), color = "red", size = 1.5, arrow = arrow(length = unit(0.4, "cm"), ends = "last")) +

    # LP Turbine
    geom_path(data = df_3b_4, aes(x = s, y = h), color = "orange", size = 2, arrow = arrow(length = unit(0.4, "cm"), ends = "last")) +

    # No Reheat (Comparison)
    geom_path(data = df_no_rh, aes(x = s, y = h), color = "gray60", size = 1, linetype = "dashed") +

    # Labels
    annotate("point",
        x = c(p3$s, p3a$s, p3b$s, p4$s, p4_old$s),
        y = c(p3$h, p3a$h, p3b$h, p4$h, p4_old$h), size = 4
    ) +
    annotate("text", x = p3$s, y = p3$h + 150, label = "3 (HP In)", size = 5, fontface = "bold") +
    annotate("text", x = p3a$s - 0.4, y = p3a$h, label = "3a (HP Out)", size = 5, fontface = "bold") +
    annotate("text", x = p3b$s, y = p3b$h + 150, label = "3b (LP In)", size = 5, fontface = "bold") +
    annotate("text", x = p4$s, y = p4$h - 150, label = "4 (LP Out)", size = 5, fontface = "bold") +
    annotate("text", x = p4_old$s - 0.1, y = p4_old$h - 150, label = "4'", size = 5, fontface = "bold", color = "gray60") +
    annotate("text", x = (p3a$s + p3b$s) / 2, y = p3b$h - 200, label = "Przegrzew Wtórny", color = "red", fontface = "bold") +
    labs(
        title = "Cykl z Przegrzewem Wtórnym",
        subtitle = "Dodatkowe ciepło q_reheat i przesunięcie punktu 4 w prawo (x rośnie)",
        x = "Entropia s [kJ/(kg·K)]", y = "Entalpia h [kJ/kg]"
    ) +
    theme_bw() +
    theme(
        plot.title = element_text(size = 18, face = "bold"),
        axis.title = element_text(size = 14)
    )
```

:::

::: {.column width="40%"}

### Analiza Wykresu{.fragment}

::: {.incremental style="font-size: 0.9em;"}
1.  **3 $\to$ 3a:** Pierwszy stopień rozprężania w turbinie wysokoprężnej (HP). Kończymy zanim para stanie się zbyt mokra.
2.  **3a $\to$ 3b:** Powrót do kotła. Dostarczamy ciepło przy stałym (niższym) ciśnieniu. Entalpia rośnie.
3.  **3b $\to$ 4:** Drugi stopień rozprężania w turbinie niskoprężnej (LP).
:::



:::
::: {.fragment .callout-tip title="**Efekt:**"}
Punkt **4** (z przegrzewem) leży znacznie bardziej na prawo niż punkt **4'** (bez przegrzewu).
Suchość pary $x_4 > x_{4'}$ (np. 0.94 vs 0.81).
:::
::::

---


## 5. Regeneracja (Podgrzewanie Wody)

::: {.callout-note appearance="simple"}
W zwykłym Rankine'ie do kotła trafia zimna woda ze skraplacza (np. 30°C).
To marnotrawstwo spalać węgiel, żeby podgrzać wodę z 30 do 100°C.
:::
::: {.fragment .callout-tip title="**Rozwiązanie:**"}
Upuszczamy część pary z turbiny (zanim wykona pełną pracę) i używamy jej ciepła skraplania do podgrzania wody zasilającej kocioł.
:::

::: {.incremental}
*   Woda wchodząca do kotła jest już gorąca.
*   Sprawność rośnie drastycznie (zbliżamy się do Carnota).
*   W nowoczesnych blokach mamy 7-9 wymienników regeneracyjnych.

:::

---

## 6. Układy Gazowo-Parowe (CCGT)

##### Combined-cycle power plant

Połączenie Braytona (W9) i Rankine'a (W10).

:::: {.columns}

::: {.column width="60%"}
::: {.incremental}
1.  **Góra (Top Cycle):** Turbina Gazowa (Spaliny wylotowe mają ~550°C).
2.  **Kocioł Odzysknicowy (HRSG):** Zamiast palić węgiel, używamy gorących spalin z TG do zagotowania wody.
3.  **Dół (Bottom Cycle):** Turbina Parowa zasilana z HRSG.
:::

::: {.fragment .callout-tip title="**Wynik:**"}
Z tego samego paliwa (gazu) mamy prąd z dwóch turbin!
Sprawność: **> 60%** (Klasyczna węglowa ma max 46%).
To obecnie najczystsza technologia spalania paliw kopalnych.
:::
:::

::: {.column width="40%"}
![](img/COGES_diagram.svg.png){width="150%" style="background: white; top;"}

::: {style="font-size: 0.6em; color: gray;"}
Źródło: <a href="https://commons.wikimedia.org/wiki/File:COGES-diagram.png">COGES-diagram</a>, <a href="https://en.wikipedia.org/wiki/Public_domain">Public domain</a>, via Wikimedia Commons

:::

::: {style="border: 2px solid #1596ea; padding: 5px; border-radius: 10px; background-color: #30b1e6; font-size: 0.6em;"}
Legenda: 1-Generatory elektryczne, 2-Turbina parowa, 3-Kondensator, 4-Pompa, 5-Kocioł/wymiennik ciepła, 6-Turbina gazowa
:::
:::
::::

---

## Podsumowanie W10

1.  **Obieg Rankine'a** rządzi światową energetyką.
2.  **Klucz do sprawności:**
    *   Wysokie parametry pary (Ciśnienie i Temperatura).
    *   Niskie ciśnienie w skraplaczu (Próżnia).
    *   Regeneracja i Przegrzew.
3.  **Skraplacz** to konieczność (zamknięcie obiegu), ale i największa strata energii (ciepło odpadowe).

### Zadanie Domowe
::: {.callout-caution appearance="simple"}
Dlaczego nie stosujemy wprost obiegu Carnota dla pary wodnej? (Dlaczego nie sprężamy pary mokrej w pompie?).
:::

::: fragment
**Odpowiedź:** Pompy źle znoszą bąbelki gazu (kawitacja), a sprężanie dwufazowe jest technicznie trudne i energochłonne. Łatwiej skroplić całość i sprężać samą ciecz.
:::
  
---

## W następnym odcinku (W11)...

### <span style="color: #2a9d8f;">Chłodnictwo i Pompy Ciepła</span>

::: {.incremental}
*   **Obiegi Lewobieżne:** Odwracamy strzałki na wykresach!
*   **II Zasada Termodynamiki w praktyce:** Jak zmusić ciepło do przepływu od ciała zimniejszego do cieplejszego?
*   **Lodówka vs Pompa Ciepła:** Dlaczego to (termodynamicznie) to samo urządzenie?
*   Nowe narzędzie inżyniera: **Wykres log p-h**.
:::

![](img/Pump_v5.gif){width="30%" fig-align="center"}

::: {style="font-size: 0.6em; color: gray;"}
Źródło: <a href="https://commons.wikimedia.org/wiki/File:Pump_v5.gif">Timpet</a>, <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>, via Wikimedia Commons
:::